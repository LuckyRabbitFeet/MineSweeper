(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,,function(e,n,t){e.exports=t.p+"images/clock_icon.png"},,,,,,,function(e,n,t){e.exports=t.p+"images/flag_icon.png"},function(e,n,t){e.exports=t.p+"images/trophy_icon.png"},function(e){e.exports=JSON.parse('{"easy":{"width":"450px","size":"45px"},"normal":{"width":"540px","size":"30px"},"hard":{"width":"600px","size":"25px"}}')},,,,,,,,,,,,,function(e,n,t){},function(e,n,t){},,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(8),c=t.n(o),i=t(14),l=t(5),s="GAME_LEVEL",u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",n=arguments.length>1?arguments[1]:void 0;switch(n.type){case s:return n.data;default:return e}},m={SET_TIMER:"SET_TIMER"},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stop",n=arguments.length>1?arguments[1]:void 0;switch(n.type){case m.SET_TIMER:return n.data;default:return e}},p="SET_MINES",d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case p:return n.data;default:return e}},v={close:0,open:1,flag:2,mistake:3},h=function(e){for(var n=[],t=0;t<e;++t)n.push(v.close);return n},E=function(e,n){for(var t=[],a=0;a<e;++a)t.push(h(n));return t};var g,S=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],w=function(e){var n=e.rows,t=e.cols,a=e.mines,r=new Array(n*t-a).fill(0),o=new Array(a).fill(9),c=r.concat(o),i=function(e,n){for(var t=[];n.length>0;)t.push(n.splice(0,e));return t}(t,c=function(e){for(var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,a=t;a;){var r=[e[n=Math.floor(Math.random()*a--)],e[a]];e[a]=r[0],e[n]=r[1]}return e}(c));return function(e){e.forEach((function(n,t){n.forEach((function(n,a){9===n&&S.forEach((function(n){var r=t+n[0],o=a+n[1];e[r]&&void 0!==e[r][o]&&9!==e[r][o]&&++e[r][o]}))}))}))}(i),i},k=E(14,18),b="SET_MATRIX",N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case b:return n.data;default:return e}},y="SET_GAME_STATUS",x="waiting",M="running",T="win",C="lose",O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case y:return n.data;default:return e}},R="SET_BEST_SCORE",I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"---",n=arguments.length>1?arguments[1]:void 0;switch(n.type){case R:return n.data;default:return e}},_=Object(l.b)({level:u,timer:f,mines:d,matrix:N,gameStatus:O,bestScore:I});g=l.c;var B,z=t(7),A=t.n(z),j=t(6),F=t.n(j),L=(t(35),function(e){var n=e.level,t=e.onChangeLevel,o=Object(a.useState)(!1),c=A()(o,2),i=c[0],l=c[1],s=function(e){e.nativeEvent.stopImmediatePropagation(),l(!i)};return Object(a.useEffect)((function(){var e=function(){i&&l(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}})),r.a.createElement("div",{className:"select"},r.a.createElement("p",{onClick:s},{easy:"低难度",normal:"中等难度",hard:"高难度"}[n],r.a.createElement("span",{className:"dorp-icon"})),r.a.createElement("div",{className:"select-menu",style:{visibility:i?"visible":null},onClick:s},r.a.createElement("ul",null,r.a.createElement("li",{className:"easy"===n?"selected":null,onClick:function(){return t("easy")}},r.a.createElement("div",null,"低难度")),r.a.createElement("li",{className:"normal"===n?"selected":null,onClick:function(){return t("normal")}},r.a.createElement("div",null,"中等难度")),r.a.createElement("li",{className:"hard"===n?"selected":null,onClick:function(){return t("hard")}},r.a.createElement("div",null,"高难度")))))}),H=t(20),D=t.n(H),J=(t(36),function(e){var n=e.mines;return r.a.createElement("div",{className:"remaining-flag"},r.a.createElement("img",{src:D.a}),r.a.createElement("span",null,n))}),P=t(9),G=t.n(P),U=t(10),V=t.n(U),X=t(11),q=t.n(X),K=t(1),Q=t.n(K),W=t(12),Y=t.n(W),Z=t(2),$=t.n(Z),ee=t(13),ne=t.n(ee),te=(t(39),null),ae=function(e){function n(e){var t;return G()(this,n),t=V()(this,q()(n).call(this,e)),$()(Q()(t),"shouldComponentUpdate",(function(e,n){return"running"!==e.gameStatus&&null!==te&&(clearTimeout(te),te=null),e.gameStatus!==t.props.gameStatus||n.time!==t.state.time})),$()(Q()(t),"componentDidUpdate",(function(e){e.gameStatus!==t.props.gameStatus&&("running"===t.props.gameStatus?t.handleTimer():"waiting"===t.props.gameStatus&&t.setTime(0))})),$()(Q()(t),"setTime",(function(e){t.props.onScore(e),t.setState({time:e})})),$()(Q()(t),"handleTimer",(function(){te=setTimeout((function(){t.state.time<999&&t.setTime(t.state.time+1),t.handleTimer()}),1e3)})),$()(Q()(t),"render",(function(){return r.a.createElement("div",{className:"clock"},r.a.createElement("img",{src:ne.a}),r.a.createElement("span",null,t.state.time.toString().padStart(3,"0")))})),t.state={time:0},t}return Y()(n,e),n}(r.a.Component),re=(t(40),function(e){var n=e.onReset,t=e.children;return r.a.createElement("div",{className:"reset",onClick:function(){n()}},r.a.createElement("span",{className:"reset-icon"}),t)}),oe=(t(41),function(e){var n=e.level,t=e.mines,a=e.gameStatus,o=e.onScore,c=e.onChangeLevel,i=e.onRestart;return r.a.createElement("header",null,r.a.createElement("div",{className:"header-wrapper"},r.a.createElement("div",{className:"meun-bar"},r.a.createElement("div",null,r.a.createElement(L,{level:n,onChangeLevel:c})),r.a.createElement("div",null,r.a.createElement("div",{className:"flag-wrapper"},r.a.createElement(J,{mines:t})),r.a.createElement("div",{className:"clock-wrapper"},r.a.createElement(ae,{gameStatus:a,onScore:o}))),r.a.createElement("div",null,r.a.createElement("div",{className:"features-wrapper"},r.a.createElement(re,{onReset:i}))))))}),ce=(t(42),["#1976D2","#388E3C","#D32F2F","#7B1FA2","#FF8F00","#48E6F1","#ED44B5","#F4C20d"]),ie=function(e){function n(e){var t;return G()(this,n),t=V()(this,q()(n).call(this,e)),$()(Q()(t),"shouldComponentUpdate",(function(e){return t.props.blockStatus!==e.blockStatus||t.props.size!==e.size||t.props.children!==e.children})),$()(Q()(t),"getRandomInt",(function(e){return Math.floor(Math.random()*Math.floor(e))})),$()(Q()(t),"leftHandle",(function(){t.props.clickBlock(v.open)})),$()(Q()(t),"rightHandle",(function(e){e.preventDefault(),t.props.blockStatus===v.close?t.props.clickBlock(v.flag,1):t.props.blockStatus===v.flag&&t.props.clickBlock(v.close,1)})),$()(Q()(t),"render",(function(){var e=t.props,n=e.color,a=e.size,o=e.blockStatus,c=e.children,i={"close-0":n&&(o===v.close||o===v.flag),"close-1":!n&&(o===v.close||o===v.flag),"open-0":n&&o===v.open,"open-1":!n&&o===v.open,flag:o===v.flag,boom:o===v.open&&9===c};c>0&&c<9&&(i["mine-"+c]=o===v.open);var l=F()("block",i),s={width:"calc(".concat(a," - 6px)"),height:"calc(".concat(a," - 6px)"),fontSize:"calc(".concat(a," - 6px)"),lineHeight:"calc(".concat(a," - 6px)")};if(o===v.open&&9===c){var u=t.getRandomInt(8);s.background=ce[u],s.borderColor=ce[u]}return r.a.createElement("span",{className:l,style:s,onClick:o===v.close?t.leftHandle:null,onContextMenu:t.rightHandle},c>0&&c<9&&o===v.open?c:"")})),t}return Y()(n,e),n}(r.a.Component),le=function(e){var n=e.blockSize,t=e.matrix,a=e.minefieldsInfo,o=e.clickBlock,c=e.minefieldsHandle,i=e.openAllBlock;return r.a.createElement("div",{className:"minefields",onClick:c},t.map((function(e,t){return r.a.createElement("p",{key:t,style:{height:n}},e.map((function(e,c){return r.a.createElement(ie,{key:c,color:t%2==0?c%2==0:!(c%2==0),size:n,blockStatus:i?v.open:e,clickBlock:function(e,n){return o({x:c,y:t},e,n)}},a[t][c])})))})))},se=t(21),ue=t.n(se),me=(t(43),function(e){var n=e.gameStatus,t=e.score,a=e.bestScore,o=e.onRestart,c=F()("finish-score",{win:n!==C,lose:n===C});return r.a.createElement("div",{className:"finish"},r.a.createElement("div",{className:c},r.a.createElement("div",{className:"finish-time"},r.a.createElement("img",{src:ne.a}),r.a.createElement("span",null,"win"===n?t.toString().padStart(3,"0"):"–––")),r.a.createElement("div",{className:"best-score"},r.a.createElement("img",{src:ue.a}),r.a.createElement("span",null,a?a.toString().padStart(3,"0"):"–––"))),r.a.createElement("div",{className:"finish-btn"},r.a.createElement(re,{onReset:o},"win"===n?"再玩一次吧":"再试一次吧")))}),fe=function(){var e=localStorage.getItem("REACT_MineSweeper");if(!e)return!1;try{e=JSON.parse(e)}catch(e){return(window.console||window.console.error)&&window.console.error("读取记录错误:",e),!1}return e}(),pe={easy:{rows:8,cols:10,mines:10},normal:{rows:14,cols:18,mines:40},hard:{rows:20,cols:24,mines:99}},de=t(22),ve=(t(44),null),he=fe||{},Ee=999,ge=Object(i.b)((function(e){return{level:e.level,mines:e.mines,matrix:e.matrix,gameStatus:e.gameStatus}}),(function(e){return{switchLevel:function(n){e({type:s,data:n})},setNumberOfMines:function(n){e({type:p,data:n})},setMatrix:function(n){e({type:b,data:n})},setGameStatus:function(n){e({type:y,data:n})}}}))((function(e){var n=e.level,t=e.mines,o=e.matrix,c=e.gameStatus,i=e.switchLevel,l=e.setNumberOfMines,s=e.setMatrix,u=e.setGameStatus,m=Object(a.useState)(w(pe[n])),f=A()(m,2),p=f[0],d=f[1],h=Object(a.useState)(!1),g=A()(h,2),k=g[0],b=g[1],N=Object(a.useState)(!1),y=A()(N,2),O=y[0],R=y[1];Object(a.useEffect)((function(){console.log(p)}),[]),Object(a.useEffect)((function(){c===C&&H()})),Object(a.useEffect)((function(){if(c===M){var e=L({result:"remainClose",returnPoints:!1}).count,t=L({result:"remainMines",returnPoints:!1}).count;e-t<=0&&_(),t<pe[n].mines&&B()}}),[o]);var I=function(e){var t,a=void 0===e?n:e;R(!1),u(x),l(pe[a].mines),t=w(pe[a]),console.log(t),d(t),s(E(pe[a].rows,pe[a].cols)),b(!1)},_=function(){var e,t;u(T),e=Ee,(!he[n]||e<he[n])&&(he[n]=e,t=he,t=JSON.stringify(t),localStorage.setItem("REACT_MineSweeper",t)),b(!0)},B=function(){u(C)},z=function(e){var n=o.map((function(n,t){return n.map((function(a,r){return e(n,a,r,t)}))}));s(n)},j=function(e,n){return-1!==e.findIndex((function(e){return e[0]===n[0]&&e[1]===n[1]}))},L=function(e){var n,t=0,a=[];switch(e.result){case"remainMines":n=function(e,n,t){return 9===t&&(o[n][e]===v.close||o[n][e]===v.flag)};break;case"remainMinesNoFlag":n=function(e,n,t){return 9===t&&o[n][e]===v.close};break;case"remainClose":n=function(e,n){return o[n][e]===v.close};break;default:throw"getMinefielosInfo: result is not allowed value"}return p.forEach((function(r,o){return r.forEach((function(r,c){n(c,o,r)&&(++t,e.returnPoints&&a.push([c,o]))}))})),{count:t,points:a}},H=function(){var e=L({result:"remainMinesNoFlag",returnPoints:!0}),n=e.count,t=e.points;0!==n||k?n>0&&k?(null!==ve&&(clearTimeout(ve),ve=null),z((function(e,n,t,a){return n===v.close&&9===p[a][t]?v.open:n}))):n>0&&(ve=setTimeout((function(){var e=t[Math.floor(Math.random()*n)];2===e.length&&z((function(n,t,a,r){return a===e[0]&&r===e[1]&&t===v.close&&9===p[r][a]?v.open:t}))}),Math.floor(160*Math.random()+100))):b(!0)},D=function(){l(t-1)},J=function(){l(t+1)};return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},r.a.createElement(oe,{level:n,mines:t,gameStatus:c,onScore:function(e){Ee=e},onChangeLevel:function(e){c!==x&&c!==M||(i(e),I(e))},onRestart:function(){c!==x&&c!==M||I()}}),r.a.createElement(le,{matrix:o,minefieldsInfo:p,blockSize:de[n].size,clickBlock:function(e,n,t){if(c===x||c===M){c===x&&u(M),1===t&&(n===v.close?J():n===v.flag&&D());var a=[];n===v.open&&function e(n,t){p[n.y]&&0===p[n.y][n.x]&&S.forEach((function(a){var r=n.x+a[0],c=n.y+a[1];p[c]&&p[c][r]<9&&o[c][r]===v.close&&!j(t,[r,c])&&(t.push([r,c]),e({x:r,y:c},t))}))}(e,a),z((function(t,r,o,c){return o===e.x&&c===e.y?n:n===v.open&&j(a,[o,c])?n:r}))}},minefieldsHandle:function(){c!==T&&c!==C||k||b(!0)},openAllBlock:O})),r.a.createElement("div",{className:F()("finish-warp",{show:k})},r.a.createElement(me,{gameStatus:c,score:Ee,bestScore:he[n],onRestart:I})),null))})),Se=(t(45),g(_,B));c.a.render(r.a.createElement(i.a,{store:Se},r.a.createElement(ge,null)),document.getElementById("root"))}],[[46,1,2]]]);
//# sourceMappingURL=main.js.map